function AVLNode(t,i){this.key=t,this.data=i,this.lChild=null,this.rChild=null,this.pre=null,this.next=null,this.pNode=null,this.height=0}function AVLTree(){this.root=null}var _proto=AVLTree.prototype;_proto.insert=function(t,i){var e=new AVLNode(t,i);if(this.root)return this._insert(this.root,e);this.root=e},_proto.delete=function(t){var i=this._delete(this.root,t);return i.pre&&(i.pre.next=i.next),i.next&&(i.next.pre=i.pre),i},_proto.search=function(t){return this._search(this.root,t)},_proto._insert=function(t,i){if(t.key==i.key)return!1;if(t.key>i.key)if(t.lChild){if(!this._insert(t.lChild,i))return!1;this._checkBalance(t)}else(t.lChild=i).pNode=t;else if(t.rChild){if(!this._insert(t.rChild,i))return!1;this._checkBalance(t)}else(t.rChild=i).pNode=t;return!i.next&&t.key>i.key?(i.next=t).pre=i:!i.pre&&t.key<i.key&&((i.pre=t).next=i),this._setHeight(t),!0},_proto._delete=function(t,i){if(!t)return!1;if(t.key!=i)return t.key>i?!!(l=this._delete(t.lChild,i))&&(this._checkBalance(t),l):!!(l=this._delete(t.rChild,i))&&(this._checkBalance(t),l);if(t.lChild||t.rChild){if(t.lChild&&t.rChild){if(this._getHeight(t.lChild)>this._getHeight(t.rChild)){for(var e=t.lChild.rChild,h=t.lChild;e&&e.rChild;)e=e.rChild;e||(e=h),this._change(t,e);var l=this._delete(t.lChild,i);return this._setHeight(e),l}for(h=t.rChild.lChild,e=t.rChild;h&&h.lChild;)h=h.lChild;h||(h=e),this._change(t,h);var l=this._delete(e,i);return this._setHeight(t),l}var r=t.lChild||t.rChild;return this.root==t?(this.root=r,this.root.pNode=null):(t.pNode.lChild==t?t.pNode.lChild=r:t.pNode.rChild=r,r.pNode=t.pNode,this._setHeight(t.pNode)),t}return this.root==t?this.root=null:(t.pNode.lChild==t?t.pNode.lChild=null:t.pNode.rChild=null,this._setHeight(t.pNode)),t},_proto._search=function(t,i){return!!t&&(t.key==i?t:t.key>i?this._search(t.lChild,i):this._search(t.rChild,i))},_proto._lRotate=function(t){var i=t.rChild;i.pNode=t.pNode,t.rChild=i.lChild,i.lChild&&(i.lChild.pNode=t),(i.lChild=t)==this.root?this.root=i:t.pNode&&(t.pNode.lChild==t?t.pNode.lChild=i:t.pNode.rChild=i),t.pNode=i},_proto._rRotate=function(t){var i=t.lChild;i.pNode=t.pNode,t.lChild=i.rChild,i.rChild&&(i.rChild.pNode=t),(i.rChild=t)==this.root?this.root=i:t.pNode&&(t.pNode.lChild==t?t.pNode.lChild=i:t.pNode.rChild=i),t.pNode=i},_proto._lrRotate=function(t){return this._lRotate(t.lChild),this._rRotate(t)},_proto._rlRotate=function(t){return this._rRotate(t.rChild),this._lRotate(t)},_proto._change=function(t,i){var e=t.key,h=t.data;t.key=i.key,t.data=i.data,i.key=e,i.data=h},_proto._checkBalance=function(t){if(t.rChild&&this._getHeight(t.rChild)-this._getHeight(t.lChild)==2){var i=t.rChild;this._getHeight(t.rChild.rChild)>this._getHeight(t.rChild.lChild)?this._lRotate(t):this._rlRotate(t),this._setHeight(t),this._setHeight(i)}else if(t.lChild&&this._getHeight(t.lChild)-this._getHeight(t.rChild)==2){var e=t.lChild;this._getHeight(t.lChild.lChild)>this._getHeight(t.lChild.rChild)?this._rRotate(t):this._lrRotate(t),this._setHeight(t),this._setHeight(e)}},_proto._getHeight=function(t){return t?t.height:0},_proto._setHeight=function(t){var i=Math.max(this._getHeight(t.lChild),this._getHeight(t.rChild))+1;t.lChild||t.rChild||(i=0),t.height=i};