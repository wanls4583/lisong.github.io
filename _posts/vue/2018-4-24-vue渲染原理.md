---
author: wanls4583
comments: true
date: 2017-06-25 07:12:22+00:00
layout: post
title: vue渲染原理
tags:
- vue

categories:
- vue
---

>vue有两种构建方式（独立构建，运行时构建），独立构建包括了编译器部分，运行时构建不包括编译器

## template,el,render的区别

template，el，render都可以指定具体渲染的内容，当实例参数中同时存在这三个参数时，其优先级为render>template>el，具体参考如下：

```html
<!DOCTYPE html>
<html>

<head>
    <title>demo</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
</head>

<body>
    <div class="vapp-1">{{ info }}</div>
    <div class="vapp-2">{{ info }}</div>
    <div class="vapp-3">{{ info }}</div>
</body>
<script type="text/javascript">
new Vue({
    el: '.vapp-1', //此时el只是指定了渲染后的挂载点
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    },
    template: '<p>这是template属性模板渲染。</p>',
    render: function(h) {
        return h('p', {}, '这是render属性方式渲染。')
    }
})

new Vue({
    el: '.vapp-2', //此时el只是指定了渲染后的挂载点
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    },
    template: '<p>这是template属性模板渲染。</p>'
})

new Vue({
    el: '.vapp-3', //此时el.outerHTML为待编译的模板
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    }
})
</script>

</html>
```

result：

![](https://wanls4583.github.io/images/posts/vue/vue渲染原理-1.jpg)

其实这三种编译模式本质都一样，template和el模板都将被编译成render函数，vue渲染是最终都是执行render函数来进行dom的挂载。

如果构建vue实例时没有指定render函数，则必须使用独立构建的vue库文件(vue.js属于独立构建的库文件)，如果将上例代码中的vue.js换成vue.runtime.js(运行时库文件)，则将报错。

```
<!DOCTYPE html>
<html>

<head>
    <title>demo</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.runtime.js"></script>
</head>

<body>
    <div class="vapp-1">{{ info }}</div>
    <div class="vapp-2">{{ info }}</div>
    <div class="vapp-3">{{ info }}</div>
</body>
<script type="text/javascript">
new Vue({
    el: '.vapp-1',
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    },
    template: '<p>这是template属性模板渲染。</p>',
    render: function(h) {
        return h('p', {}, '这是render属性方式渲染。')
    }
})

new Vue({
    el: '.vapp-2',
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    },
    template: '<p>这是template属性模板渲染。</p>'
})

new Vue({
    el: '.vapp-3',
    data: {
        info: '这是通过el属性获取挂载元素的outerHTML方式渲染。'
    }
})
</script>

</html>
```

result:

![](https://wanls4583.github.io/images/posts/vue/vue渲染原理-2.jpg)

webpack打包vue项目时默认使用的是运行时库，如果需要使用独立构建的库，可以配置别名

```javascript
resolve: {
    alias: {
        'vue$': 'vue/dist/vue.common.js', //针对CommonJS模式
        //'vue$': 'vue/dist/vue.esm.js', //针对ES Module模式
        //'vue$': 'vue/dist/vue.js', //针对UMD模式
    }
}
```

## render函数
